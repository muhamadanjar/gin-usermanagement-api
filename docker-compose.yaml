services:
  app1:
    image: alpine:latest # Or another lightweight image
    expose:
      - "8001"
    volumes:
      - ./build/usersmanagement:/app/usersmanagementservice # Mount the compiled binary
    working_dir: /app
    environment:
      - GO_ENV=development
      - SERVICE_ID=app1
      - DATABASE_HOST=postgres-container # Replace this with the hostname of your PostgreSQL container
      - DATABASE_USER=dtouser
      - DATABASE_NAME=kemen_usermanagement
      - DATABASE_PORT=5432
    command: >
      sh -c "./usermanagementservice"
    networks:
      - shared-network

  nginx:
    image: nginx:latest
    container_name: nginx-usersmanagement
    ports:
      - "8001:80"
    volumes:
      - ./nginx.conf:/etc/nginx/conf.d/default.conf
    depends_on:
      - app1
    networks:
      - shared-network
networks:
 - shared-network:
      external: true